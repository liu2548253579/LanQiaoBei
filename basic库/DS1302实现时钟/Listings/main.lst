C51 COMPILER V9.54   MAIN                                                                  12/27/2022 15:52:40 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "STC15F2K60S2.H"
   2          #include "DS1302.H"
   3          
   4          char tik8ms; //Ê±¼ä±êÖ¾Î»£¬ÓÐ°Ë¸ö×´Ì¬Ã¿°ËºÁÃë¸üÐÂÒ»´Î
   5          char smg[8];// ÓÃÀ´´æ´¢Ã¿¸öÊýÂë¹ÜÏÔÊ¾µÄ¶«Î÷£¨¾ßÌåÏÔÊ¾Ê²Ã´²Î¿¼Êý×ét_display£©
   6          
   7          
   8          //Ê±ÖÓ
   9          unsigned char szds1302[]={22,33,44}; //³õÊ¼Ê±¼äÎª22.33.44
  10          unsigned char shijian[6]={0,0,0,0,0,0};//´æ´¢Ê±¼äÊý×é
  11          
  12          
  13          //ÏÂÃæÁ½¸ö±äÁ¿²»ÓÃ¼ÇÒä¿ÉÒÔ´ÓSTC¡ªISPÈí¼þÖÐ»ñÈ¡£¨ÓÒÉÏ½Ç±ßÀ¸µÄ -> STC¿ª·¢°å£¨ÊÔÑéÏä4Ê¾Àý³ÌÐò£©-> H595Çý¶¯ÊýÂ
             -ë¹Ü ¡ª> C£©
  14          
  15          /*************  ±¾µØ³£Á¿ÉùÃ÷    **************/
  16          char t_display[]={                       //±ê×¼×Ö¿â
  17          //   0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
  18              0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F,0x77,0x7C,0x39,0x5E,0x79,0x71,
  19          //black  -     H    J    K    L    N    o   P    U     t    G    Q    r   M    y
  20              0x00,0x40,0x76,0x1E,0x70,0x38,0x37,0x5C,0x73,0x3E,0x78,0x3d,0x67,0x50,0x37,0x6e,
  21              0xBF,0x86,0xDB,0xCF,0xE6,0xED,0xFD,0x87,0xFF,0xEF,0x46};    //0. 1. 2. 3. 4. 5. 6. 7. 8. 9. -1
  22          
  23          char T_COM[]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80}; //Î»Âë
  24          
  25          
  26          //¶¨Ê±Æ÷ÅäÖÃ¿ÉÒÔ´ÓSTC¡ªISPÈí¼þÖÐµÄ¶¨Ê±Æ÷¼ÆËãÆ÷ÖÐ»ñµÃ £¨1ms 16Î»×Ô¶¯ÖØÔØ 1TÖ¸Áî¼¯£©
  27          //×¢Òâ×îºóÁ½ÐÐÐèÒª×ÔÐÐÌí¼Ó£¨  ET1 = 1; EA = 1;£©
  28          void Timer1Init(void)   //1ºÁÃë@12.000MHz
  29          {
  30   1        AUXR |= 0x40;   //¶¨Ê±Æ÷Ê±ÖÓ1TÄ£Ê½
  31   1        TMOD &= 0x0F;   //ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
  32   1        TL1 = 0x20;   //ÉèÖÃ¶¨Ê±³õÖµ
  33   1        TH1 = 0xD1;   //ÉèÖÃ¶¨Ê±³õÖµ
  34   1        TF1 = 0;    //Çå³ýTF1±êÖ¾
  35   1        TR1 = 1;    //¶¨Ê±Æ÷1¿ªÊ¼¼ÆÊ±
  36   1        ET1 = 1;                           //´ò¿ª¶¨Ê±Æ÷Ò»£¨ÐèÒª×ÔÐÐÌí¼Ó£©
  37   1        EA = 1;                            //´ò¿ªÖÐ¶Ï¿ª¹Ø£¨ÐèÒª×ÔÐÐÌí¼Ó£©
  38   1      }
  39          
  40          
  41          
  42          
  43          //ÊýÂë¹ÜÏÔÊ¾µ¥Ôª
  44          void SMG(char wei,char number)
  45          {
  46   1      P2=0XC0;P0=T_COM[wei];P2=0X00; //¶ÎÑ¡ 
  47   1      P2=0XE0;P0=~t_display[number];P2=0X00;//Î»Ñ¡£¨×¢ÒâSTCÌá¹©µÄÊÇ¹²ÒõÂëÊ¹ÓÃÊ±×¢ÒâÈ¡·´£©
  48   1      P0=0X00; //Ïû³ý¹íÓ°½¨Òé¼ÓÉÏ
  49   1      }
  50          
  51          int main (void)
  52          {
  53   1      P2=0X80;P0=0XFF;P2=0X00;//¹Ø±ÕLED
C51 COMPILER V9.54   MAIN                                                                  12/27/2022 15:52:40 PAGE 2   

  54   1      P2=0XA0;P0=0X00;P2=0X00;//¹Ø±Õ¼ÌµçÆ÷ºÍ·äÃùÆ÷
  55   1      Timer1Init();//¶¨Ê±Æ÷Ò»³õÊ¼»¯
  56   1      wwrite_ds1302(szds1302);//Éè¶¨³õÊ¼Ê±¼ä
  57   1      while(1)
  58   1      {
  59   2        smg[0]=shijian[0];//Ð¡Ê±Ê®Î»
  60   2        smg[1]=shijian[1];//Ð¡Ê±¸öÎ»
  61   2        
  62   2        smg[2]=17;
  63   2        
  64   2        smg[3]=shijian[2];//·ÖÖÓÊ®Î»
  65   2        smg[4]=shijian[3];//·ÖÖÓ¸öÎ»  
  66   2        
  67   2        smg[5]=17;
  68   2      
  69   2        smg[6]=shijian[4];//ÃëÊ®Î»
  70   2        smg[7]=shijian[5];//Ãë¸öÎ»  
  71   2      }
  72   1      }
  73          
  74          void server ()interrupt 3  //¶¨Ê±Æ÷1·þÎñº¯ÊýÃû×Ö¿ÉËæÒâµ«ÊÇºóÃæÒ»¶¨Òª¼Ó interrupt 3£¨ÓÉÓÚÅäÖÃµÄ1ms£¬¼´Ã¿Ò»º
             -ÁÃë¾Í»á½øÈë´Ë·þÎñº¯Êý£©
  75          {
  76   1      tik8ms=tik8ms+1;   //ÈÃÆäÃ¿Ò»ºÁÃë×ÔÔöÒ»
  77   1      if(tik8ms==8)tik8ms=0; //ÏÞ¶¨ÆäÔÚ0-7Ñ­»·
  78   1      rread_ds1302(shijian);
  79   1      
  80   1      SMG(tik8ms,smg[tik8ms]); //Öð¸öË¢ÐÂÊýÂë¹Ü 
  81   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    191    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     69    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
