C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "stc15f2k60s2.h"
   2          #include "iic.h"
   3          #include "ds1302.h"
   4          #include "intrins.h"
   5          
   6          #define TX P10 
   7          #define RX P11
   8          
   9          bit relay,buzzer;//¼ÌµçÆ÷£¬·äÃùÆ÷¿ØÖÆ±êÖ¾Î»
  10          bit working_mode=1;//ÎªÁãÊÇ×Ô¶¯ÃÅÎªÒ»ÊÇÃÜÂëÃÅ
  11          bit door_5s,buzzer_3s;//·äÃùÆ÷ºÍ¼ÌµçÆ÷µÄÑÓÊ±Æô¶¯±êÖ¾Î»
  12          unsigned int gao=654,di=321;//ÓÃÓÚ´æ´¢ÃÜÂëµÄ¸ßÈıÎ»ºÍµÍÈıÎ»
  13          unsigned char display_mode,logic_mode,key_enter_flag,key_value,error_times;//ÏÔÊ¾Ä£Ê½ Âß¼­Ä£Ê½ °´¼üÊäÈë±êÖ
             -¾Î»£¨Î»Êı£© ¼üÖµ ´íÎó´ÎÊı
  14          unsigned char tick_8ms,tick_10ms,SMG[8],shi,fen,miao;//8msÊ±¼ä±êÖ¾ 10msÊ±¼ä±êÖ¾ ÊıÂë¹ÜË¢ĞÂÄÚÈİ Ê± ·Ö Ãë
  15          unsigned int juli=999;//²â¾à¾àÀë 
  16          unsigned int password[6]={16,16,16,16,16,16},password_gao,password_di;//ÁùÎ»ÃÜÂëÊäÈëÔİ´æÎ» Ôİ´æ¸ßÈıÎ» Ôİ´æ
             -µÍÈıÎ»
  17          
  18          unsigned char code t_display[]={                       //±ê×¼×Ö¿â
  19          //   0    1    2    3    4    5    6    7    8    9    A    B    C    D    E    F
  20              0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F,0x77,0x7C,0x39,0x5E,0x79,0x71,
  21          //black  -     H    J    K    L    N    o   P    U     t    G    Q    r   M    y
  22              0x00,0x40,0x76,0x1E,0x70,0x38,0x37,0x5C,0x73,0x3E,0x78,0x3d,0x67,0x50,0x37,0x6e,
  23              0xBF,0x86,0xDB,0xCF,0xE6,0xED,0xFD,0x87,0xFF,0xEF,0x46};    //0. 1. 2. 3. 4. 5. 6. 7. 8. 9. -1
  24          
  25          unsigned char code T_COM[]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};      //Î»Âë
  26          
  27          void Timer0Init(void)   //12Î¢Ãë@12.000MHz
  28          {
  29   1        AUXR &= 0x7F;   //¶¨Ê±Æ÷Ê±ÖÓ12TÄ£Ê½
  30   1        TMOD &= 0xF0;   //ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
  31   1        TL0 = 0xF4;   //ÉèÖÃ¶¨Ê±³õÖµ
  32   1        TH0 = 0xFF;   //ÉèÖÃ¶¨Ê±³õÖµ
  33   1        TF0 = 0;    //Çå³ıTF0±êÖ¾
  34   1        TR0 = 1;    //¶¨Ê±Æ÷0¿ªÊ¼¼ÆÊ±
  35   1      }
  36          
  37          
  38          unsigned int ceju(void)//²âÁ¿ÎïÌå¾àÀë
  39          {
  40   1        unsigned char a=10;
  41   1        unsigned int juli=0;
  42   1        Timer0Init();
  43   1        TX=0;//¹Ø±Õ·¢ËÍÂö³å
  44   1        
  45   1        while(a--)//·¢ËÍÊ®¸öÂö³å
  46   1        {
  47   2          while(!TF0);//µÈ´ıÒç³ö  
  48   2          TX=1;//¿ªÊ¼·¢ËÍÂö³å
  49   2          TF0=0;//ÇåÁãÒç³ö±êÖ¾Î»
  50   2        }
  51   1          TR0=0;//¹Ø±Õ¶¨Ê±Æ÷0
  52   1        
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 2   

  53   1          TH0=0;//¶¨Ê±Æ÷0¸ßÎ»ÇåÁã
  54   1          TL0=0;//¶¨Ê±Æ÷0µÍÎ»ÇåÁã
  55   1        
  56   1          TR0=1;//´ò¿ª¶¨Ê±Æ÷0¿ªÊ¼¼ÆÊ±
  57   1        
  58   1        while(RX&&!TF0);//µ±RX½ÓÊÕµ½Âö³å»òÕßTF0Òç³öÊ±¼ÌĞø
  59   1        if(TF0==1){juli=999;}//TF0Òç³ö¾àÀëÉèÎªÎŞÇî´ó¼´Îª999cm
  60   1        else{juli=((TH0<<8)+TL0)*0.017;}//¸ù¾İ¾àÀëÊ±¼ä¹«Ê½¼ÆËãÊµ¼Ê¾àÀë
  61   1        
  62   1        TR0=0;//¹Ø±Õ¶¨Ê±Æ÷0   
  63   1        return juli;
  64   1      }
  65          
  66          void hardware_control (void)//Ó²¼ş¿ØÖÆ
  67          {
  68   1      P0=0X00;
  69   1      P2=0XA0;
  70   1      if(buzzer==1){P06=1;}
  71   1      if(buzzer==0){P06=0;}
  72   1      
  73   1      if(relay==1){P04=1;}
  74   1      if(relay==0){P04=0;}
  75   1      P2=0X00;
  76   1      }
  77          
  78          
  79          void init_ds1302 (unsigned char shi_set,unsigned char fen_set,unsigned char miao_set)//ÉèÖÃds1302Ê±¼ä²¢¸üĞ
             -Âµ½È«¾Ö±äÁ¿
  80          {
  81   1      Write_Ds1302_Byte(0x8e,0x00);
  82   1      Write_Ds1302_Byte(0x80,miao_set); 
  83   1      Write_Ds1302_Byte(0x82,fen_set);
  84   1      Write_Ds1302_Byte(0x84,shi_set);  
  85   1      Write_Ds1302_Byte(0x8e,0x80); 
  86   1      shi=Read_Ds1302_Byte(0x85);
  87   1      fen=Read_Ds1302_Byte(0x83);
  88   1      miao=Read_Ds1302_Byte(0x81);
  89   1      }
  90          
  91          void read_ds1302 (void)//¶ÁÈ¡²¢¸üĞÂds1302Ê±ÖÓĞÅÏ¢
  92          {
  93   1        EA=0;
  94   1      shi=Read_Ds1302_Byte(0x85);
  95   1      fen=Read_Ds1302_Byte(0x83);
  96   1      miao=Read_Ds1302_Byte(0x81);
  97   1        EA=1;
  98   1      }
  99          
 100          void display_ds1302 (void)//ÏÔÊ¾Ê±¼ä
 101          {
 102   1      SMG[0]=shi/16;
 103   1      SMG[1]=shi%16;
 104   1      SMG[2]=17;
 105   1      SMG[3]=fen/16;
 106   1      SMG[4]=fen%16;
 107   1      SMG[5]=17;
 108   1      SMG[6]=miao/16;
 109   1      SMG[7]=miao%16;
 110   1      }
 111          
 112          void display_enter (void)//ÏÔÊ¾ÊäÃÜÂëµÄ½çÃæ
 113          {
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 3   

 114   1      SMG[0]=17;
 115   1      SMG[1]=17;
 116   1      SMG[2]=password[0];
 117   1      SMG[3]=password[1];
 118   1      SMG[4]=password[2];
 119   1      SMG[5]=password[3];
 120   1      SMG[6]=password[4];
 121   1      SMG[7]=password[5];
 122   1      }
 123          
 124          void display_config (void)//ÏÔÊ¾È·ÈÏ¾ÉÃÜÂë½çÃæ
 125          {
 126   1      SMG[0]=16;
 127   1      SMG[1]=17;
 128   1      SMG[2]=password[0];
 129   1      SMG[3]=password[1];
 130   1      SMG[4]=password[2];
 131   1      SMG[5]=password[3];
 132   1      SMG[6]=password[4];
 133   1      SMG[7]=password[5];
 134   1      }
 135          
 136          void display_new (void)//ÏÔÊ¾ÊäÈëĞÂÃÜÂë½çÃæ
 137          {
 138   1      SMG[0]=17;
 139   1      SMG[1]=16;
 140   1      SMG[2]=password[0];
 141   1      SMG[3]=password[1];
 142   1      SMG[4]=password[2];
 143   1      SMG[5]=password[3];
 144   1      SMG[6]=password[4];
 145   1      SMG[7]=password[5];
 146   1      }
 147          
 148          void display_change (void)//ÃÜÂëÄ£Ê½ÈıÖÖ×´Ì¬ÇĞ»»
 149          {
 150   1      if(display_mode==0){display_enter();}
 151   1      if(display_mode==1){display_config();}
 152   1      if(display_mode==2){display_new();}
 153   1      }
 154          
 155          void Delay4ms()   //@12.000MHz   4msÑÓÊ±¸ø24c02ÓÃ
 156          {
 157   1        unsigned char i, j;
 158   1      
 159   1        i = 47;
 160   1        j = 174;
 161   1        do
 162   1        {
 163   2          while (--j);
 164   2        } while (--i);
 165   1      }
 166          
 167          unsigned char config_24c02_state (unsigned char mode)//ÉèÖÃ»òÕß¶ÁÈ¡24c02ÃÜÂëÊÇ·ñ±»¸ÄĞ´¹ı
 168          {
 169   1      if(mode==0){Delay4ms();write_24c02 (0x07,0);}
 170   1      if(mode==1){Delay4ms();write_24c02 (0x07,7);} 
 171   1      Delay4ms(); 
 172   1      return read_24c02(0x07);  
 173   1      }
 174          
 175          
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 4   

 176          //½«ÃÜÂëĞ´Èë24c02
 177          void write_password (unsigned char a1,unsigned char a2,unsigned char a3,unsigned char a4,unsigned char a5,
             -unsigned char a6)
 178          {
 179   1      write_24c02 (0x01,a1);
 180   1      Delay4ms();
 181   1      write_24c02 (0x02,a2);  
 182   1      Delay4ms();
 183   1      write_24c02 (0x03,a3);
 184   1      Delay4ms();
 185   1      write_24c02 (0x04,a4);
 186   1      Delay4ms();
 187   1      write_24c02 (0x05,a5);
 188   1      Delay4ms();
 189   1      write_24c02 (0x06,a6);  
 190   1      Delay4ms();
 191   1      }
 192          
 193          
 194          //½«ÃÜÂë´Ó24c02¸üĞÂµ½gaoºÍdi
 195          void read_password (void)
 196          {
 197   1      unsigned char a1,a2,a3,a4,a5,a6;
 198   1      if(config_24c02_state(2)==7)//Èç¹ûÃÜÂë±»¸ÄĞ´¹ıÔò¶ÁÈ¡
 199   1      {
 200   2      a1=read_24c02(0x01);
 201   2      a2=read_24c02(0x02);
 202   2      a3=read_24c02(0x03);
 203   2      a4=read_24c02(0x04);
 204   2      a5=read_24c02(0x05);
 205   2      a6=read_24c02(0x06);  
 206   2      Delay4ms();
 207   2      gao=a1*100+a2*10+a3;
 208   2      di=a4*100+a5*10+a6;
 209   2      }
 210   1      }
 211          
 212          
 213          void smg (unsigned char duan,unsigned char wei)//ÊıÂë¹ÜË¢ĞÂµ¥Ôª
 214          {
 215   1      P0=0XFF;
 216   1      P2=0XC0;P0=T_COM[duan];P2=0X00;
 217   1      P2=0XE0;P0=~t_display[wei];P2=0X00;
 218   1      }
 219          
 220          void Timer1Init(void)   //1ºÁÃë@12.000MHz
 221          {
 222   1        AUXR |= 0x40;   //¶¨Ê±Æ÷Ê±ÖÓ1TÄ£Ê½
 223   1        TMOD &= 0x0F;   //ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
 224   1        TL1 = 0x20;   //ÉèÖÃ¶¨Ê±³õÖµ
 225   1        TH1 = 0xD1;   //ÉèÖÃ¶¨Ê±³õÖµ
 226   1        TF1 = 0;    //Çå³ıTF1±êÖ¾
 227   1        TR1 = 1;    //¶¨Ê±Æ÷1¿ªÊ¼¼ÆÊ±
 228   1        ET1=1;
 229   1        EA=1;
 230   1      }
 231          
 232          void key_task (void)//°´¼ü°´ÏÂÖ´ĞĞµÄÈÎÎñ
 233          {
 234   1      
 235   1      }
 236          
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 5   

 237          
 238          unsigned char read_keyboard (void)//·µ»Ø¶ÁÈ¡µ½µÄ°´¼ü¼üÖµÈôÎŞ°´¼ü°´ÏÂÔò·µ»Ø99
 239          {
 240   1      static unsigned char keyboard_tick;//ÂÖÑ¯±êÖ¾Î»
 241   1      unsigned char key_val,key_trig=0;//¼üÖµÔİ´æ£¬´¥·¢±êÖ¾
 242   1      
 243   1      key_trig=0; //ÇåÁã´¥·¢
 244   1        
 245   1      if(keyboard_tick==0)
 246   1      {
 247   2      P30=0;P31=1;P32=1;P33=1;
 248   2      if(P44==0){while(!P44){key_task();}key_val=0;key_trig=1;} 
 249   2      if(P42==0){while(!P42){key_task();}key_val=1;key_trig=1;} 
 250   2      if(P35==0){while(!P35){key_task();}key_val=2;key_trig=1;} 
 251   2      if(P34==0){while(!P34){key_task();}key_val=3;key_trig=1;} 
 252   2      } 
 253   1      
 254   1      
 255   1      if(keyboard_tick==1)
 256   1      {
 257   2      P30=1;P31=0;P32=1;P33=1;  
 258   2      if(P44==0){while(!P44){key_task();}key_val=4;key_trig=1;} 
 259   2      if(P42==0){while(!P42){key_task();}key_val=5;key_trig=1;} 
 260   2      if(P35==0){while(!P35){key_task();}key_val=6;key_trig=1;} 
 261   2      if(P34==0){while(!P34){key_task();}key_val=7;key_trig=1;} 
 262   2      }
 263   1      
 264   1      if(keyboard_tick==2)
 265   1      {
 266   2      P30=1;P31=1;P32=0;P33=1;
 267   2      if(P44==0){while(!P44){key_task();}key_val=8;key_trig=1;} 
 268   2      if(P42==0){while(!P42){key_task();}key_val=9;key_trig=1;} 
 269   2      if(P35==0){while(!P35){key_task();}key_val=10;key_trig=1;}//  ÉèÖÃ
 270   2      if(P34==0){while(!P34){key_task();}key_val=11;key_trig=1;}  //¸´Î»
 271   2      }
 272   1      
 273   1      if(keyboard_tick==3)
 274   1      {
 275   2      P30=1;P31=1;P32=1;P33=0;
 276   2      if(P35==0){while(!P35){key_task();}key_val=12;key_trig=1;}//  È·ÈÏ
 277   2      if(P34==0){while(!P34){key_task();}key_val=13;key_trig=1;}  //ÍË³ö
 278   2      }
 279   1      keyboard_tick=keyboard_tick+1;//ÂÖÑ¯¼üÅÌ
 280   1      
 281   1      if(keyboard_tick==4){keyboard_tick=0;}
 282   1      
 283   1      
 284   1      if(key_trig){return key_val;}//Èç¹û´¥·¢Ôò·µ»Ø¼üÖµ
 285   1      else{return 99;}//Èç¹ûÎ´´¥·¢Ôò·µ»Ø´íÎóÂë99
 286   1      }
 287          
 288          void clean_password (void)//Çå³ıÊäÈëµÄÎ»ÊıºÍÊı×Ö
 289          {
 290   1      password[0]=16,password[1]=16,password[2]=16,password[3]=16,password[4]=16,password[5]=16;
 291   1      key_enter_flag=0;
 292   1      }
 293          
 294          void control_center (void)//ÏµÍ³Âß¼­ÖĞĞÄ
 295          {
 296   1      if(working_mode==0)//×Ô¶¯ÃÅ
 297   1      {
 298   2      display_ds1302 ();//ÏÔÊ¾Ê±¼ä½çÃæ
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 6   

 299   2      if(juli<30){relay=1;door_5s=1;}//Èç¹û¾àÀëÉÙÓÚ30cmÔò¿ªÃÅ
 300   2      }
 301   1      
 302   1      if(working_mode==1)//ÃÜÂëÃÅ
 303   1      {
 304   2      display_change();//ÏÔÊ¾²»Í¬µÄÃÜÂëÃÅÏÔÊ¾
 305   2      if(key_value==11){write_password (6,5,4,3,2,1);read_password(); config_24c02_state(0);}//¸´Î» ÉèÖÃÃÜÂëÎª65
             -4321 ¶ÁÈ¡ÃÜÂë ½«24c02×´Ì¬ÖÃÎªÎ´¸ÄĞ´
 306   2      
 307   2      
 308   2      
 309   2      
 310   2      if(logic_mode==0)//ÃÜÂëÊäÈëÄ£Ê½
 311   2      {
 312   3      display_mode=0;//ÇĞ»»ÃÜÂëÄ£Ê½ÏÔÊ¾ÎªÊäÈëÏÔÊ¾
 313   3      if(key_value<=9){password[key_enter_flag]=key_value;key_enter_flag=key_enter_flag+1;if(key_enter_flag>=5){
             -key_enter_flag=5;}}//Èç¹û¼üÖµĞ¡ÓÚ9£¨ÎªÊı×Ö£©Ôò ½«¶ÔÓ¦µÄÎ»Êı¸³Öµ¸ø¶ÔÓ¦µÄÊı×é ²¢ÏŞÖÆÊäÈëÁùÎ»Êı
 314   3      
 315   3      if(key_value==12)//È·ÈÏ
 316   3      {
 317   4      password_gao=password[0]*100+password[1]*10+password[2];//ÊäÈë¸ßÈıÎ»ÃÜÂë¸³Öµ¸øÔİ´æ¸ßÈıÎ»
 318   4      password_di=password[3]*100+password[4]*10+password[5];//ÊäÈëµÍÈıÎ»ÃÜÂë¸³Öµ¸øÔİ´æµÍÈıÎ»
 319   4      if(password_gao==gao)//ÅĞ¶ÏÃÜÂëÊÇ·ñÕıÈ·
 320   4      {
 321   5      if(password_di==di){clean_password();error_times=0;relay=1;door_5s=1;}//Çå³ıÊäÈë ½«´íÎó´ÎÊıÖÃÁã ´ò¿ª¼ÌµçÆ÷
             - ¿ªÆôÑÓÊ±5s
 322   5      }
 323   4      
 324   4      else{error_times++;clean_password();}//ÃÜÂë´íÎó ´íÎó´ÎÊı¼ÓÒ» Çå³ıÊäÈë
 325   4      if(error_times>=3){error_times=0;buzzer=1;buzzer_3s=1;}//´íÎó´ÎÊı´óÓÚÈı´Î ÇåÁã´íÎó´ÎÊı ´ò¿ª·äÃùÆ÷ ¿ªÆôÑÓÊ±
             -3s
 326   4      }
 327   3      
 328   3      }
 329   2      
 330   2      if(key_value==10)//ÉèÖÃ
 331   2      {
 332   3      clean_password();//Çå³ıÊäÈë
 333   3      logic_mode=1;//ÇĞ»»ÎªÃÜÂëÉèÖÃÄ£Ê½
 334   3      }
 335   2      
 336   2      
 337   2      if(logic_mode==1)//ÃÜÂëÉèÖÃÄ£Ê½
 338   2      {
 339   3      display_mode=1;//ÇĞ»»ÃÜÂëÄ£Ê½ÏÔÊ¾ÎªÉèÖÃÏÔÊ¾
 340   3      if(key_value==13){logic_mode=0;clean_password();}//ÍË³ö ÇĞ»»ÎªÃÜÂëÊäÈëÄ£Ê½ Çå³ıÊäÈë
 341   3      else
 342   3      {
 343   4      if(key_value<=9){password[key_enter_flag]=key_value;key_enter_flag=key_enter_flag+1;if(key_enter_flag>=5){
             -key_enter_flag=5;}}//Èç¹û¼üÖµĞ¡ÓÚ9£¨ÎªÊı×Ö£©Ôò ½«¶ÔÓ¦µÄÎ»Êı¸³Öµ¸ø¶ÔÓ¦µÄÊı×é ²¢ÏŞÖÆÊäÈëÁùÎ»Êı
 344   4      if(key_value==12)//È·ÈÏ
 345   4      {
 346   5      password_gao=password[0]*100+password[1]*10+password[2];//ÊäÈë¸ßÈıÎ»ÃÜÂë¸³Öµ¸øÔİ´æ¸ßÈıÎ»
 347   5      password_di=password[3]*100+password[4]*10+password[5];//ÊäÈëµÍÈıÎ»ÃÜÂë¸³Öµ¸øÔİ´æµÍÈıÎ»
 348   5      if(password_gao==gao)//ÅĞ¶ÏÃÜÂëÊÇ·ñÕıÈ·
 349   5      {
 350   6      if(password_di==di){clean_password();logic_mode=2;error_times=0;key_value=99;}//Çå³ıÊäÈë ÇĞ»»ÎªĞÂÃÜÂëÊäÈëÄ
             -£Ê½ ½«´íÎó´ÎÊıÖÃÁã ½«¼üÖµÔİÊ±ÉèÖÃÎª99ÒÔÃâ¿ìËÙÈ·ÈÏÁ½´Î
 351   6      }
 352   5      
 353   5      else{error_times++;clean_password();}//ÃÜÂë´íÎó ´íÎó´ÎÊı¼ÓÒ» Çå³ıÊäÈë
 354   5      if(error_times>=3){error_times=0;buzzer=1;buzzer_3s=1;logic_mode=0;}//´íÎó´ÎÊı´óÓÚÈı´Î ÇåÁã´íÎó´ÎÊı ´ò¿ª·ä
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 7   

             -ÃùÆ÷ ¿ªÆôÑÓÊ±3s
 355   5      }
 356   4      }
 357   3      }
 358   2      
 359   2      if(logic_mode==2)//ĞÂÃÜÂëÅäÖÃ
 360   2      {
 361   3      display_mode=2;//ÇĞ»»ÃÜÂëÄ£Ê½ÏÔÊ¾ÎªĞÂÃÜÂëÊäÈëÏÔÊ¾
 362   3      if(key_value==13){logic_mode=0;clean_password();}//ÍË³ö
 363   3      else
 364   3      {
 365   4      if(key_value<=9){password[key_enter_flag]=key_value;key_enter_flag=key_enter_flag+1;if(key_enter_flag>=5){
             -key_enter_flag=5;}}//Èç¹û¼üÖµĞ¡ÓÚ9£¨ÎªÊı×Ö£©Ôò ½«¶ÔÓ¦µÄÎ»Êı¸³Öµ¸ø¶ÔÓ¦µÄÊı×é ²¢ÏŞÖÆÊäÈëÁùÎ»Êı
 366   4      if(key_value==12)//È·ÈÏ
 367   4      {
 368   5      write_password (password[0],password[1],password[2],password[3],password[4],password[5]);//½«¶ÔÓ¦µÄĞÂÃÜÂëÖ
             -ğ¸öĞ´Èë¶ÔÓ¦µÄÎ»ÖÃ
 369   5      read_password();//¸üĞÂÃÜÂëµ½Êı×é
 370   5      config_24c02_state(1);//¸ü¸ÄÃÜÂë¸ÄĞ´×´Ì¬Îª¾­¹ıĞŞ¸Ä
 371   5      clean_password();//Çå³ıÊäÈë
 372   5      logic_mode=0; //ÇĞ»»ÎªÃÜÂëÊäÈëÄ£Ê½
 373   5      }
 374   4      }
 375   3      }
 376   2      
 377   2      }
 378   1      
 379   1      }
 380          
 381          void mode_control (void)//¸ù¾İÊ±¼äÇĞ»»¹¤×÷Ä£Ê½
 382          {
 383   1      if(shi>=0x07){if(shi<=0x21){working_mode=0;}}//£¨7µãµ½21µã59·Ö59ÃëÎª×Ô¶¯ÃÅ£©
 384   1      else{working_mode=1;}//£¨ÆäÓàÊ±¼äÎªÃÜÂëÃÅ£©
 385   1      }
 386          
 387          void task_schedule (void)//¶¨Ê±Æ÷ÈÎÎñµ÷¶È
 388          {
 389   1      if(tick_10ms>=10)
 390   1      {
 391   2      tick_10ms=0;
 392   2      juli = ceju();//»ñÈ¡¾àÀë
 393   2      read_ds1302 ();//¶ÁÈ¡Ê±¼ä
 394   2      mode_control ();//¸ù¾İÊ±¼ä¿ØÖÆ¹¤×÷Ä£Ê½
 395   2      }
 396   1      }
 397          
 398          
 399          int main (void)
 400          {
 401   1      P2=0X80;P0=0XFF;P2=0X00;//¹Ø±ÕLEDÍâÉè
 402   1      P2=0XA0;P0=0X00;P2=0X00;//¹Ø±Õ¼ÌµçÆ÷·äÃùÆ÷ÍâÉè
 403   1      P34=1;P35=1;P42=1;P44=1;//³õÊ¼»¯°´¼üÒı½Å
 404   1      init_ds1302 (0x06,0x59,0x00);//ÉèÖÃ³õÊ¼»¯Ê±¼ä
 405   1      //write_password (6,5,4,3,2,1);//Ğ´³õÊ¼ÃÜÂëµ½24c02
 406   1      read_password();//¶ÁÈ¡24c02ÃÜÂë¸üĞÂµ½Êı×é
 407   1      Timer1Init();//ÈÎÎñµ÷¶È¶¨Ê±Æ÷³õÊ¼»¯
 408   1      while(1)
 409   1      { 
 410   2      key_value=read_keyboard();//¶ÁÈ¡¼üÖµ
 411   2      task_schedule ();//ÈÎÎñµ÷¶È
 412   2      control_center ();//ÏµÍ³ÖĞ¿Ø£¨×Ô¶¯ÃÅºÍÃÜÂëÃÅÂß¼­ÊµÏÖ£©
 413   2      }
C51 COMPILER V9.54   MAIN                                                                  05/01/2022 06:26:50 PAGE 8   

 414   1        
 415   1      }
 416          
 417          void server () interrupt 3
 418          {
 419   1      static unsigned int tick_5s,tick_3s;//tick_5s,tick_3s;
 420   1      tick_10ms++;//Ê®ÃëÈÎÎñµ÷¶È±êÖ¾Î»
 421   1      if(door_5s==1){tick_5s++;if(tick_5s==5000){tick_5s=0;door_5s=0;relay=0;}}//¼ÌµçÆ÷ÎåÃëÑÓÊ±
 422   1      if(buzzer_3s==1){tick_3s++;if(tick_3s==3000){tick_3s=0;buzzer_3s=0;buzzer=0;}}//·äÃùÆ÷ÈıÃëÑÓÊ±
 423   1      tick_8ms++;if(tick_8ms==8){tick_8ms=0;}//ÊıÂë¹ÜÉ¨Ãè±êÖ¾Î»
 424   1      smg(tick_8ms,SMG[tick_8ms]);//ÊıÂë¹Ü¸üĞÂ  
 425   1      hardware_control ();//Ó²¼ş×´Ì¬¸üĞÂ  £¨·äÃùÆ÷¡¢¼ÌµçÆ÷£©
 426   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1737    ----
   CONSTANT SIZE    =     51    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     45      15
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      5    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
